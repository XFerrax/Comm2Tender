import{r as j,l as H,e as K,H as C,h as N}from"./SI7jkw24.js";import{d as F,r as x,H as L,t as p,L as v,A as s,z as i,M as l,X as y,B as P,ab as I,V as d,$ as b,au as n,av as m,N as k,v as M,O as z,P as T,Q as $,R as W,S as R,T as q,U as X,W as Y,Y as Z,Z as Q,a0 as B,a1 as J,a2 as _,a3 as h}from"./01VIqO6s.js";import{m as V,a as w,b as ee,c as te,d as le,e as ie}from"./BSqYvhTr.js";import{_ as G}from"./C097zIPZ.js";const oe=F({__name:"Proposal",props:V,emits:["update:isActive"],setup(g,{emit:E}){const u=g,f=E,r={requiredRule:j,lengthRule:H,emailRule:K},c=x(u.isActive),e=x({proposalId:0,agentId:0,userId:0,tenderId:0,countPos:0,positionPrice:0,deliveryCost:0,deliveryTime:0,prepaidExpense1:0,prepaidExpense2:0,prepaidExpense3:0,periodOfExecution1:0,periodOfExecution2:0,periodOfExecution3:0,postPaymant1:0,postPaymant2:0,postPaymant3:0,postPaymantPeriod1:0,postPaymantPeriod2:0,postPaymantPeriod3:0,accreditive:!1,bankGuarantee:!1,customDuty:!1,customFee:!1,missingDeadlines:!1,poorQuality:!1,normsViolated:!1,experienceCooperation:!1,experienceMarket:!1,fines:!1,intermediary:!1,productionAndInventory:!1,modernEquipment:!1,georgraphy:!1,concessions:!1,complaints:!1});L(()=>u.editedItem,t=>{e.value.proposalId=t==null?void 0:t.proposalId,e.value.agentId=t==null?void 0:t.agent.agentId,e.value.userId=t==null?void 0:t.user.userId,e.value.tenderId=t==null?void 0:t.tender.tenderId,e.value.countPos=t==null?void 0:t.countPos,e.value.positionPrice=t==null?void 0:t.positionPrice,e.value.deliveryCost=t==null?void 0:t.deliveryCost,e.value.deliveryTime=t==null?void 0:t.deliveryTime,e.value.prepaidExpense1=t==null?void 0:t.prepaidExpense1,e.value.prepaidExpense2=t==null?void 0:t.prepaidExpense2,e.value.prepaidExpense3=t==null?void 0:t.prepaidExpense3,e.value.periodOfExecution1=t==null?void 0:t.periodOfExecution1,e.value.periodOfExecution2=t==null?void 0:t.periodOfExecution2,e.value.periodOfExecution3=t==null?void 0:t.periodOfExecution3,e.value.postPaymant1=t==null?void 0:t.postPaymant1,e.value.postPaymant2=t==null?void 0:t.postPaymant2,e.value.postPaymant3=t==null?void 0:t.postPaymant3,e.value.postPaymantPeriod1=t==null?void 0:t.postPaymantPeriod1,e.value.postPaymantPeriod2=t==null?void 0:t.postPaymantPeriod2,e.value.postPaymantPeriod3=t==null?void 0:t.postPaymantPeriod3,e.value.accreditive=t==null?void 0:t.accreditive,e.value.bankGuarantee=t==null?void 0:t.bankGuarantee,e.value.customDuty=t==null?void 0:t.customDuty,e.value.customFee=t==null?void 0:t.customFee,e.value.missingDeadlines=t==null?void 0:t.missingDeadlines,e.value.poorQuality=t==null?void 0:t.poorQuality});const O=()=>{const t={proposalId:e.value.proposalId,agent:{agentId:e.value.agentId},user:{userId:0},tender:{tenderId:e.value.tenderId},countPos:e.value.countPos,positionPrice:e.value.positionPrice,deliveryCost:e.value.deliveryCost,deliveryTime:e.value.deliveryTime,prepaidExpense1:e.value.prepaidExpense1,prepaidExpense2:e.value.prepaidExpense2,prepaidExpense3:e.value.prepaidExpense3,periodOfExecution1:e.value.periodOfExecution1,periodOfExecution2:e.value.periodOfExecution2,periodOfExecution3:e.value.periodOfExecution3,postPaymant1:e.value.postPaymant1,postPaymant2:e.value.postPaymant2,postPaymant3:e.value.postPaymant3,postPaymantPeriod1:e.value.postPaymantPeriod1,postPaymantPeriod2:e.value.postPaymantPeriod2,postPaymantPeriod3:e.value.postPaymantPeriod3,accreditive:e.value.accreditive,bankGuarantee:e.value.bankGuarantee,customDuty:e.value.customDuty,customFee:e.value.customFee,missingDeadlines:e.value.missingDeadlines,poorQuality:e.value.poorQuality},a=N().BuildQuery(u.isNew?C.post:C.put,t);u.isNew?k(u.apiAddress,a).then(()=>{c.value=!1}):k(`${u.apiAddress}/${t.proposalId}`,t).then(()=>{c.value=!1})},A=()=>{f("update:isActive",!1)};return(t,o)=>(p(),v(w,{isActive:u.isActive,"onUpdate:isActive":o[23]||(o[23]=a=>u.isActive=a),"save-func":O,title:u.title,"title-suffix":u.titleSuffix,"close-func":A,"is-new":u.isNew},{fields:s(()=>[i(G,{modelValue:l(e).agentId,"onUpdate:modelValue":o[0]||(o[0]=a=>l(e).agentId=a),visible:!0,rules:[r.requiredRule],"api-address":"agent","item-title":"name",label:"Контрагент"},null,8,["modelValue","rules"]),i(G,{modelValue:l(e).tenderId,"onUpdate:modelValue":o[1]||(o[1]=a=>l(e).tenderId=a),visible:!0,rules:[r.requiredRule],"api-address":"tender","item-title":"number",label:"Тендер"},null,8,["modelValue","rules"]),i(y),i(I,null,{default:s(()=>[P("Объем закупки")]),_:1}),i(d,{label:"Количество товара(услуг), ед","prepend-icon":"mdi-briefcase-account",variant:"outlined",rules:[r.requiredRule],modelValue:l(e).countPos,"onUpdate:modelValue":o[2]||(o[2]=a=>l(e).countPos=a)},null,8,["rules","modelValue"]),i(d,{label:"Стоимость 1 ед товара(услуги)","prepend-icon":"mdi-briefcase-account",variant:"outlined",rules:[r.requiredRule],modelValue:l(e).positionPrice,"onUpdate:modelValue":o[3]||(o[3]=a=>l(e).positionPrice=a)},null,8,["rules","modelValue"]),i(d,{label:"Стоимость доставки, руб.","prepend-icon":"mdi-cash",variant:"outlined",rules:[r.requiredRule],modelValue:l(e).deliveryCost,"onUpdate:modelValue":o[4]||(o[4]=a=>l(e).deliveryCost=a)},null,8,["rules","modelValue"]),i(d,{label:"Сроки поставки, дн","prepend-icon":"mdi-timer-settings-outline",variant:"outlined",rules:[r.requiredRule],modelValue:l(e).deliveryTime,"onUpdate:modelValue":o[5]||(o[5]=a=>l(e).deliveryTime=a)},{default:s(()=>[i(b,{activator:"parent",location:"top",text:"Количество дней между датой заключения договора(или первого аванса) и даты поставки товара. Шаг рассчета 5 дней"})]),_:1},8,["rules","modelValue"]),i(y),i(I,null,{default:s(()=>[P("Условия оплаты")]),_:1}),i(d,{label:"Аванс 1","prepend-icon":"mdi-cash",variant:"outlined",rules:[r.requiredRule],modelValue:l(e).prepaidExpense1,"onUpdate:modelValue":o[6]||(o[6]=a=>l(e).prepaidExpense1=a)},null,8,["rules","modelValue"]),i(d,{label:"Аванс 2","prepend-icon":"mdi-cash",variant:"outlined",rules:[r.requiredRule],modelValue:l(e).prepaidExpense2,"onUpdate:modelValue":o[7]||(o[7]=a=>l(e).prepaidExpense2=a)},null,8,["rules","modelValue"]),i(d,{label:"Аванс 3","prepend-icon":"mdi-cash",variant:"outlined",rules:[r.requiredRule],modelValue:l(e).prepaidExpense3,"onUpdate:modelValue":o[8]||(o[8]=a=>l(e).prepaidExpense3=a)},null,8,["rules","modelValue"]),i(d,{label:"Срок аванса 1, дн","prepend-icon":"mdi-timer-settings-outline",variant:"outlined",rules:[r.requiredRule],modelValue:l(e).periodOfExecution1,"onUpdate:modelValue":o[9]||(o[9]=a=>l(e).periodOfExecution1=a)},{default:s(()=>[i(b,{text:"Количество дней между датой аванса и датой поступления товара на склад. Шаг рассчета 5 дней"})]),_:1},8,["rules","modelValue"]),i(d,{label:"Срок аванса 2, дн","prepend-icon":"mdi-timer-settings-outline",variant:"outlined",rules:[r.requiredRule],modelValue:l(e).periodOfExecution2,"onUpdate:modelValue":o[10]||(o[10]=a=>l(e).periodOfExecution2=a)},null,8,["rules","modelValue"]),i(d,{label:"Срок аванса 3, дн","prepend-icon":"mdi-timer-settings-outline",variant:"outlined",rules:[r.requiredRule],modelValue:l(e).periodOfExecution3,"onUpdate:modelValue":o[11]||(o[11]=a=>l(e).periodOfExecution3=a)},null,8,["rules","modelValue"]),i(d,{label:"Постоплата 1, %","prepend-icon":"mdi-cash-100",variant:"outlined",rules:[r.requiredRule],modelValue:l(e).postPaymant1,"onUpdate:modelValue":o[12]||(o[12]=a=>l(e).postPaymant1=a)},null,8,["rules","modelValue"]),i(d,{label:"Постоплата 2, %","prepend-icon":"mdi-cash-100",variant:"outlined",rules:[r.requiredRule],modelValue:l(e).postPaymant2,"onUpdate:modelValue":o[13]||(o[13]=a=>l(e).postPaymant2=a)},null,8,["rules","modelValue"]),i(d,{label:"Постоплата 3, %","prepend-icon":"mdi-cash-100",variant:"outlined",rules:[r.requiredRule],modelValue:l(e).postPaymant3,"onUpdate:modelValue":o[14]||(o[14]=a=>l(e).postPaymant3=a)},null,8,["rules","modelValue"]),i(d,{label:"Срок постоплаты 1, дн","prepend-icon":"mdi-timer-settings-outline",variant:"outlined",rules:[r.requiredRule],modelValue:l(e).postPaymantPeriod1,"onUpdate:modelValue":o[15]||(o[15]=a=>l(e).postPaymantPeriod1=a)},{default:s(()=>[i(b,{text:"Количество дней между датой поставки товаров и планируемой датой постоплаты. Шаг рассчета 5 дней"})]),_:1},8,["rules","modelValue"]),i(d,{label:"Срок постоплаты 2, дн","prepend-icon":"mdi-timer-settings-outline",variant:"outlined",rules:[r.requiredRule],modelValue:l(e).postPaymantPeriod2,"onUpdate:modelValue":o[16]||(o[16]=a=>l(e).postPaymantPeriod2=a)},null,8,["rules","modelValue"]),i(d,{label:"Срок постоплаты 3, дн","prepend-icon":"mdi-timer-settings-outline",variant:"outlined",rules:[r.requiredRule],modelValue:l(e).postPaymantPeriod3,"onUpdate:modelValue":o[17]||(o[17]=a=>l(e).postPaymantPeriod3=a)},null,8,["rules","modelValue"]),i(y),i(I,null,{default:s(()=>[P("Дополнительные условия")]),_:1}),i(m,{inline:"",label:"Банковские условия",rules:[r.requiredRule]},{default:s(()=>[i(n,{label:"Нет","true-value":()=>{l(e).accreditive=!1,l(e).bankGuarantee=!1}},null,8,["true-value"]),i(n,{label:"Банковская гарантия","false-value":()=>{l(e).bankGuarantee=!1},"true-value":()=>{l(e).bankGuarantee=!0}},null,8,["false-value","true-value"]),i(n,{label:"Аккредитив","false-value":()=>{l(e).accreditive=!1},"true-value":()=>{l(e).accreditive=!0}},null,8,["false-value","true-value"])]),_:1},8,["rules"]),i(m,{inline:"",label:"Таможенное условие 1",modelValue:l(e).customDuty,"onUpdate:modelValue":o[18]||(o[18]=a=>l(e).customDuty=a),rules:[r.requiredRule]},{default:s(()=>[i(n,{label:"Нет",value:"false"}),i(n,{label:"Таможенная пошлина",value:"true"})]),_:1},8,["modelValue","rules"]),i(m,{inline:"",label:"Таможенное условие 2",modelValue:l(e).customFee,"onUpdate:modelValue":o[19]||(o[19]=a=>l(e).customFee=a),rules:[r.requiredRule]},{default:s(()=>[i(n,{label:"Нет",value:"false"}),i(n,{label:"Таможенный сбор",value:"true"})]),_:1},8,["modelValue","rules"]),i(y),i(I,null,{default:s(()=>[P("Критерии надежности")]),_:1}),i(m,{inline:"",label:"Были нарушения сроков поставки",modelValue:l(e).missingDeadlines,"onUpdate:modelValue":o[20]||(o[20]=a=>l(e).missingDeadlines=a),rules:[r.requiredRule]},{default:s(()=>[i(n,{label:"Да",value:"true"}),i(n,{label:"Нет",value:"false"})]),_:1},8,["modelValue","rules"]),i(m,{inline:"",label:"Были претензии к качеству товара/услуги",modelValue:l(e).poorQuality,"onUpdate:modelValue":o[21]||(o[21]=a=>l(e).poorQuality=a),rules:[r.requiredRule]},{default:s(()=>[i(n,{label:"Да",value:"true"}),i(n,{label:"Нет",value:"false"})]),_:1},8,["modelValue","rules"]),i(m,{inline:"",label:"Были нарушения внутренних норм",modelValue:l(e).normsViolated,"onUpdate:modelValue":o[22]||(o[22]=a=>l(e).normsViolated=a),rules:[r.requiredRule]},{default:s(()=>[i(n,{label:"Да",value:"true"}),i(n,{label:"Нет",value:"false"})]),_:1},8,["modelValue","rules"])]),_:1},8,["isActive","title","title-suffix","is-new"]))}}),U="proposal",ae="Заявки",ue="заявки",se=F({__name:"Proposal",props:ee,setup(g){var E=g;const u=te(),f=N(),r=`${U}Id`,c=x([{title:"ID заявки",key:r,align:"end",sortable:!0},{title:"Контрагент",key:"agent.name",align:"start",sortable:!0}]);E.readonly||c.value.push({title:"Действия",key:"actions",align:"center",sortable:!1});const e=()=>{if(!u.loading.value){u.mixinBeforeRequest();const t=f.BuildQuery(C.post,f.getListRequest({pagination:u.pagination.value,search:u.search.value}));k(`${U}/search`,t).then(o=>{u.items=x(o.items),u.total=o.total,u.mixinAfterRequest(!0)})}},O=()=>{const t=f.BuildQuery(C.delete);k(`${U}/${u.editedItem.value.proposalId}`,t).then(o=>{u.items=x(o.items),u.total=o.total,u.mixinAfterRequest(!0)})},A=()=>{u.isNew.value=!0,u.isForm.value=!0};return(t,o)=>(p(),M(h,null,[t.visible?(p(),v(_,{key:0,wrap:""},{default:s(()=>[i(J,{title:ae,flat:"",width:"100%"},{text:s(()=>[i(z,null,{default:s(()=>[i(T,null,{default:s(()=>[i($,{class:"d-flex justify-center",cols:"6"},{default:s(()=>[t.hideSearch?R("",!0):(p(),v(d,{key:0,modelValue:l(u).search.value,"onUpdate:modelValue":o[0]||(o[0]=a=>l(u).search.value=a),label:"Поиск","prepend-icon":"mdi-magnify","single-line":"","hide-details":"",clearable:"",onKeydown:W(e,["enter"])},null,8,["modelValue"]))]),_:1}),i($,{class:"d-flex justify-center"},{default:s(()=>[t.hideSearch?R("",!0):(p(),v(q,{key:0,disabled:l(u).loading.value,"prepend-icon":"mdi-refresh",class:"align-self-center",text:"Поиск",onClick:e},null,8,["disabled"]))]),_:1}),i(X),i($,{class:"d-flex justify-center"},{default:s(()=>[("readonly"in t?t.readonly:l(Y))?R("",!0):(p(),v(q,{key:0,color:"primary","prepend-icon":"mdi-plus",class:"align-self-center",onClick:A,text:"Добавить"}))]),_:1})]),_:1})]),_:1})]),default:s(()=>[i(y),i(Z,{modelValue:l(u).selected,"onUpdate:modelValue":o[1]||(o[1]=a=>l(u).selected=a),"show-select":t.selectMulti,headers:c.value,items:l(u).items.value,"footer-props":{"Элементов на странице":10},options:l(u).pagination,"server-items-length":l(u).total,loading:l(u).loading.value,"item-key":r},{"item.isActive":s(({item:a})=>[i(Q,{icon:a.isActive?"mdi-check-circle-outline":"mdi-close-circle-outline",color:a.isActive?"green":"red"},null,8,["icon","color"])]),"item.actions":s(({item:a})=>[i(T,{"no-gutters":"",align:"center",justify:"center",class:"flex-nowrap"},{default:s(()=>[i(b,{location:"bottom","open-delay":1e3,"close-delay":0,text:"Редактировать"},{activator:s(({props:D})=>[i(q,B({density:"comfortable",icon:"",class:"mx-1",variant:"tonal",color:"primary"},D,{onClick:S=>l(u).mixinEditItem(a)}),{default:s(()=>[i(Q,null,{default:s(()=>[P("mdi-pencil")]),_:1})]),_:2},1040,["onClick"])]),_:2},1024),i(b,{location:"bottom","open-delay":1e3,"close-delay":0,text:"Удалить"},{activator:s(({props:D})=>[i(q,B({density:"comfortable",icon:"",class:"mx-1",variant:"tonal",color:"error"},D,{onClick:S=>l(u).mixinDeleteItem(a)}),null,16,["onClick"])]),_:2},1024)]),_:2},1024)]),"no-data":s(()=>[i(le,{text:"Нет данных",icon:"mdi-alert-circle-outline",outlined:""})]),_:2},1032,["modelValue","show-select","headers","items","options","server-items-length","loading"])]),_:1})]),_:1})):R("",!0),i(oe,{isActive:l(u).isForm.value,"onUpdate:isActive":o[2]||(o[2]=a=>l(u).isForm.value=a),"title-suffix":ue,"is-new":l(u).isNew.value,"edited-item":l(u).editedItem,"api-address":U},null,8,["isActive","is-new","edited-item"]),i(ie,{isOpen:l(u).isDialogConfirm.value,onConfirm:O,onCancel:o[3]||(o[3]=a=>l(u).isDialogConfirm.value=!1)},null,8,["isOpen"])],64))}}),me=F({__name:"proposals",setup(g){return(E,u)=>(p(),v(se))}});export{me as default};
