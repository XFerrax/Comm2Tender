import{aD as T,N as a,aE as u,u as d,aF as p,i as k}from"./01VIqO6s.js";const h=S(),m=T({id:"auth",state:()=>({}),getters:{accessToken:()=>f("accessToken"),refreshToken:()=>f("refreshToken")},actions:{setTokens(t){t.accessToken?l("accessToken",t.accessToken):g("accessToken"),t.refreshToken?l("refreshToken",t.refreshToken,14400):g("refreshToken")},login(t,o,e){a("auth/login",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({login:t,password:o})}).then(n=>{const s=n;this.setTokens({accessToken:s.accessToken,refreshToken:s.refreshToken}),a("auth/getUserView",h.BuildQuery(i.get)).then(r=>{const c=u();c.removeMenuItem(),c.setMenuItems(r.menuItems),e.push(r.menuItems[0].path)})}).catch(()=>{this.logout()})},logout(){a("auth/logout",h.BuildQuery(i.get)).catch().finally(()=>{u().removeMenuItem(),this.setTokens({accessToken:null,refreshToken:null}),d().push("/login")})}}});function l(t,o,e){const n=new Date,s=o;e?n.setTime(n.getTime()+e*1e3):n.setTime(n.getTime()+60*60*1e3),document.cookie=t+"="+s+"; expires="+n.toUTCString()+"; path=/"}function f(t){var n;const e=("; "+document.cookie).split("; "+t+"=");if(e.length==2)return(n=e.pop())==null?void 0:n.split(";").shift()}function g(t){const o=new Date;o.setTime(o.getTime()+-1*24*60*60*1e3),document.cookie=t+"=; expires="+o.toUTCString()+"; path=/"}var i=(t=>(t.get="GET",t.post="POST",t.put="PUT",t.delete="DELETE",t))(i||{});function S(){return{getListRequest:function(e){return p(e.pagination)&&(e.pagination={page:1,itemsPerPage:-1}),e.sort||(e.sort=[]),e.search||(e.search=""),e.isActual||(e.isActual=!1),e.filter||(e.filter=[]),{page:e.pagination?e.pagination.page:1,size:e.pagination?e.pagination.itemsPerPage:-1,search:e.search.trim(),sort:e.sort,filter:e.filter,dateTime:e.dateTime,isActual:e.isActual}},BuildQuery:function(e,n){const s=m();return e=="POST"||e=="PUT"?{method:e.toString(),headers:{"Content-Type":"application/json",Authorization:`Bearer ${k(()=>s.accessToken).value}`},body:JSON.stringify(n)}:{method:e.toString(),headers:{"Content-Type":"application/json",Authorization:`Bearer ${s.accessToken}`}}}}}function P(t){return!!t||"Обязательное поле"}function $(t){return!t||/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/i.test(t)||"Проверьте правильность заполнения"}function C(t,o){if(!o)return console.log(o),"Неправильно установлено правило проверки";const e=t==null?void 0:t.length,n=o.min,s=o.max,r="Количество символов должно быть "+(n!==void 0&&s!==void 0?n===s?`${n}`:`от ${n} до ${s}`:n!==void 0?`не менее ${n}`:`не более ${s}`);return t&&(n!==void 0&&e<n||s!==void 0&&e>s)?r:!0}export{i as H,$ as e,S as h,C as l,P as r,m as u};
