import{d as $,r as p,H as U,t as r,L as u,A as o,z as s,M as a,V as k,N as g,o as w,v as S,O as T,P as I,Q as b,R as Q,S as y,T as A,U as j,W as P,X as H,Y as K,Z as D,$ as V,a0 as q,B as L,a1 as M,a2 as O,a3 as E}from"./01VIqO6s.js";import{r as z,l as W,e as X,H as F,h as B}from"./SI7jkw24.js";import{m as Y,_ as R,a as Z,b as G,c as J,d as ee,e as te}from"./BSqYvhTr.js";const se=$({__name:"CustomsFee",props:Y,emits:["update:isActive"],setup(f,{emit:v}){const e=f,m=v,d={requiredRule:z,lengthRule:W,emailRule:X},c=p(e.isActive),n=p({customFeeDictionaryId:0,minAmount:0,summaryCustomFee:0});U(()=>e.editedItem,t=>{n.value.customFeeDictionaryId=t==null?void 0:t.customFeeDictionaryId,n.value.minAmount=t==null?void 0:t.minAmount,n.value.summaryCustomFee=t==null?void 0:t.summaryCustomFee});const x=()=>{const t={customFeeDictionaryId:n.value.customFeeDictionaryId,minAmount:n.value.minAmount,summaryCustomFee:n.value.summaryCustomFee},l=B().BuildQuery(e.isNew?F.post:F.put,t);e.isNew?g(e.apiAddress,l).then(()=>{c.value=!1}):g(`${e.apiAddress}/${t.customFeeDictionaryId}`,t).then(()=>{c.value=!1})},h=()=>{m("update:isActive",!1)};return(t,i)=>(r(),u(Z,{isActive:e.isActive,"onUpdate:isActive":i[2]||(i[2]=l=>e.isActive=l),"save-func":x,title:e.title,"title-suffix":e.titleSuffix,"close-func":h,"is-new":e.isNew},{fields:o(()=>[s(k,{modelValue:a(n).minAmount,"onUpdate:modelValue":i[0]||(i[0]=l=>a(n).minAmount=l),rules:[d.requiredRule],counter:50},{label:o(()=>[s(R,{label:"Нижняя граница действия пошлины",required:""})]),_:1},8,["modelValue","rules"]),s(k,{modelValue:a(n).summaryCustomFee,"onUpdate:modelValue":i[1]||(i[1]=l=>a(n).summaryCustomFee=l),rules:[d.requiredRule]},{label:o(()=>[s(R,{label:"Пошлина",required:""})]),_:1},8,["modelValue","rules"])]),_:1},8,["isActive","title","title-suffix","is-new"]))}}),C="сustomFeeDictionary",ie="Таможенные пошлины",ae="таможенной пошлины",le=$({__name:"CustomsFee",props:G,setup(f){var v=f;const e=J(),m=B(),d=`${C}Id`,c=p([{title:"ID записи",key:d,align:"end",sortable:!0},{title:"Минимальный порог",key:"minAmount",align:"start",sortable:!0},{title:"Значение пошлины",key:"summaryCustomFee",align:"start",sortable:!0}]);v.readonly||c.value.push({title:"Действия",key:"actions",align:"center",sortable:!1}),w(()=>n());const n=()=>{if(!e.loading.value){e.mixinBeforeRequest();const t=m.BuildQuery(F.post,m.getListRequest({pagination:e.pagination.value,search:e.search.value}));g(`${C}/search`,t).then(i=>{e.items=p(i.items),e.total=i.total,e.mixinAfterRequest(!0)})}},x=()=>{const t=m.BuildQuery(F.delete);g(`${C}/${e.editedItem.value.сustomFeeDictionaryId}`,t).then(i=>{e.items=p(i.items),e.total=i.total,e.mixinAfterRequest(!0)})},h=()=>{e.isNew.value=!0,e.isForm.value=!0};return(t,i)=>(r(),S(E,null,[t.visible?(r(),u(O,{key:0,wrap:""},{default:o(()=>[s(M,{title:ie,flat:"",width:"100%"},{text:o(()=>[s(T,null,{default:o(()=>[s(I,null,{default:o(()=>[s(b,{class:"d-flex justify-center",cols:"6"},{default:o(()=>[t.hideSearch?y("",!0):(r(),u(k,{key:0,modelValue:a(e).search.value,"onUpdate:modelValue":i[0]||(i[0]=l=>a(e).search.value=l),label:"Поиск","prepend-icon":"mdi-magnify","single-line":"","hide-details":"",clearable:"",onKeydown:Q(n,["enter"])},null,8,["modelValue"]))]),_:1}),s(b,{class:"d-flex justify-center"},{default:o(()=>[t.hideSearch?y("",!0):(r(),u(A,{key:0,disabled:a(e).loading.value,"prepend-icon":"mdi-refresh",class:"align-self-center",text:"Поиск",onClick:n},null,8,["disabled"]))]),_:1}),s(j),s(b,{class:"d-flex justify-center"},{default:o(()=>[("readonly"in t?t.readonly:a(P))?y("",!0):(r(),u(A,{key:0,color:"primary","prepend-icon":"mdi-plus",class:"align-self-center",onClick:h,text:"Добавить"}))]),_:1})]),_:1})]),_:1})]),default:o(()=>[s(H),s(K,{modelValue:a(e).selected,"onUpdate:modelValue":i[1]||(i[1]=l=>a(e).selected=l),"show-select":t.selectMulti,headers:c.value,items:a(e).items.value,"footer-props":{"Элементов на странице":10},options:a(e).pagination,"server-items-length":a(e).total,loading:a(e).loading.value,"item-key":d},{"item.isActive":o(({item:l})=>[s(D,{icon:l.isActive?"mdi-check-circle-outline":"mdi-close-circle-outline",color:l.isActive?"green":"red"},null,8,["icon","color"])]),"item.actions":o(({item:l})=>[s(I,{"no-gutters":"",align:"center",justify:"center",class:"flex-nowrap"},{default:o(()=>[s(V,{location:"bottom","open-delay":1e3,"close-delay":0,text:"Редактировать"},{activator:o(({props:_})=>[s(A,q({density:"comfortable",icon:"",class:"mx-1",variant:"tonal",color:"primary"},_,{onClick:N=>a(e).mixinEditItem(l)}),{default:o(()=>[s(D,null,{default:o(()=>[L("mdi-pencil")]),_:1})]),_:2},1040,["onClick"])]),_:2},1024),s(V,{location:"bottom","open-delay":1e3,"close-delay":0,text:"Удалить"},{activator:o(({props:_})=>[s(A,q({density:"comfortable",icon:"",class:"mx-1",variant:"tonal",color:"error"},_,{onClick:N=>a(e).mixinDeleteItem(l)}),null,16,["onClick"])]),_:2},1024)]),_:2},1024)]),"no-data":o(()=>[s(ee,{text:"Нет данных",icon:"mdi-alert-circle-outline",outlined:""})]),_:2},1032,["modelValue","show-select","headers","items","options","server-items-length","loading"])]),_:1})]),_:1})):y("",!0),s(se,{isActive:a(e).isForm.value,"onUpdate:isActive":i[2]||(i[2]=l=>a(e).isForm.value=l),"title-suffix":ae,"is-new":a(e).isNew.value,"edited-item":a(e).editedItem,"api-address":C},null,8,["isActive","is-new","edited-item"]),s(te,{isOpen:a(e).isDialogConfirm.value,onConfirm:x,onCancel:i[3]||(i[3]=l=>a(e).isDialogConfirm.value=!1)},null,8,["isOpen"])],64))}}),ue=$({__name:"customsfee",setup(f){return(v,e)=>(r(),u(le))}});export{ue as default};
